
{% extends 'home.html' %}

{% block title %} <title>Multiplayer Pong - Lobby</title> {% endblock title %}

{% block game-section %}

    <div id="gameWrapper">
        <h1>Create a new game:</h1>
        
        What game room would you like to join/create?<br><br><br>
        <div id="input-container">
            <input id="room-name-input" type="text" size="100" placeholder="Enter room name ..."><br>
            <button id="room-name-submit" type="button" class="glow-on-hover">Enter</button>
        </div>
        
        {% if error %}
        <p style="color: red;">{{ error }}</p>
        {% endif %}
    </div>

<script>
    const inputField = document.querySelector('#room-name-input');
    const submitButton = document.querySelector('#room-name-submit');

    // Focus on input field
    inputField.focus();

    // Trigger submit on Enter key
    inputField.onkeyup = function(e) {
        if (e.key === 'Enter') {  
            submitButton.click();
        }
    };

    // Trigger submit when user pastes content
    inputField.addEventListener('paste', function() {
        setTimeout(() => submitButton.click(), 0); // Ensures pasted text is captured
    });

    function validateRoomName(roomName) {
    // Regular expression that only allows alphanumeric characters
    const validPattern = /^[a-zA-Z0-9]+$/;
    
    if (!roomName) {
        alert("Room Name Error: Room name cannot be empty");
        return false;
    }
    
    if (!validPattern.test(roomName)) {
        alert("Invalid Format: Room name can only contain letters and numbers (no spaces or special characters)");
        return false;
    }
    
    return true;
    }

    submitButton.onclick = function() {
    const roomName = inputField.value.trim();
    
    if (validateRoomName(roomName)) {
        window.location.pathname = '/online-game/' + roomName + '/';
    }
    };
</script>

{% endblock game-section %}
